
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data &#8212; LocalRQA  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modules/data';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RQA Data Format" href="data/data_description.html" />
    <link rel="prev" title="Quickstart" href="../getting_started/quickstart.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">LocalRQA  documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Data</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="data/data_description.html">RQA Data Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="data/data_preparation.html">Prepare RQA Data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="training.html">Training</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="training/retriever.html">Training a Retriever</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="training/retriever/ctl.html">Contrastive Learning (CTL)</a></li>
<li class="toctree-l3"><a class="reference internal" href="training/retriever/dca.html">Distill from Cross-Attention scores (DCA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="training/retriever/rpg.html">Distill from an LMâ€™s probability distribution (RPG)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="training/generator.html">Training a Generator</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="training/generator/sft.html">SFT with Gold Data (SFT)</a></li>
<li class="toctree-l3"><a class="reference internal" href="training/generator/swr.html">SFT with a Frozen Retriever (SwR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="training/generator/fid.html">Fusion-in-Decoder Training (FiD)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="evaluation.html">Evaluation</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="evaluation/eval_retriever.html">Retriever Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="evaluation/eval_e2e.html">End-to-End Evaluation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="serving.html">Serving</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="serving/human_eval.html">Static Human Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="serving/interactive.html">Interactive Chat</a></li>
<li class="toctree-l2"><a class="reference internal" href="serving/acc_frameworks.html">Inference Acceleration Frameworks</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Playground</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../playground/custom_rqa.html">Customize your RQA system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../playground/custom_trainer.html">Customize Model Trainers</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../usecases/databricks.html">Databricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usecases/faire.html">Faire</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api_reference/local_rqa.html">local_rqa namespace</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/local_rqa.evaluation.html">local_rqa.evaluation package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/local_rqa.guardrails.html">local_rqa.guardrails package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/local_rqa.pipelines.html">local_rqa.pipelines package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/local_rqa.qa_llms.html">local_rqa.qa_llms package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/local_rqa.retrievers.html">local_rqa.retrievers package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/local_rqa.schema.html">local_rqa.schema package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/local_rqa.serve.html">local_rqa.serve package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/local_rqa.text_loaders.html">local_rqa.text_loaders package</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api_reference/local_rqa.trainers.html">local_rqa.trainers namespace</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/local_rqa.trainers.qa_llm.html">local_rqa.trainers.qa_llm namespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/local_rqa.trainers.retriever.html">local_rqa.trainers.retriever namespace</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/modules/data.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-data-do-we-need">What Data Do We Need?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-data">Training Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation-data">Evaluation Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#serving-data">Serving Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-schema">Data Schema</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-obtain-rqa-data">How to Obtain RQA Data?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="data">
<span id="data-main"></span><h1>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h1>
<p>Training, evaluating, or serving an RQA system requires data. Depending on your use case, what data you need to prepare <strong>will vary</strong>. In a standard workflow with full model training â†’ evaluation â†’ deployment, you will need: 1) a <strong>collection of documents</strong> acting as a database, and 2) a collection of <strong>question-passage-answer triplets</strong> used for training and evaluation.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/sample-flow.png"><img alt="Example workflow using LocalRQA" src="../_images/sample-flow.png" style="width: 55%;" /></a>
<figcaption>
<p><span class="caption-text">Example workflow using LocalRQA. The data components are colored in <strong>blue</strong>.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As an example, a (simplified) document database may look like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Configure access to the `default.people10m` table\n\nEnable the user you created ...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;## Updated required permissions for new workspaces\n\n  **February 28, 2023**\n\n  The [set of required permissions] ...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="err">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>and (simplified) examples of question-passage-answer triplets may look like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;question&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;How can I enable a user to access a specific table in Databricks?&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;passage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Configure access to the `default.people10m` table\n\nEnable the user you created ...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;answer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;To enable a user to access a specific table in Databricks, you can follow these steps: ...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;question&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;How can I access ADLS2 with UC external locations in Databricks?&quot;</span>
<span class="w">        </span><span class="nt">&quot;passage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;## Access &lt;ADLS2&gt; with &lt;UC&gt; external locations\n\n  .. note:: &lt;ADLS2&gt; is ...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;answer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;You can access Azure Data Lake Storage Gen2 (ADLS2) with Unity Catalog (UC) by ...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="err">...</span>
<span class="p">]</span>
</pre></div>
</div>
<section id="what-data-do-we-need">
<h2>What Data Do We Need?<a class="headerlink" href="#what-data-do-we-need" title="Link to this heading">#</a></h2>
<p>Depending on how you wish to use LocalRQA, you may <strong>not</strong> need all the data mentioned above. In this section, we provide high-level explanations of the kind of data you will use for training, evaluation, and serving an RQA system.</p>
<section id="training-data">
<h3>Training Data<a class="headerlink" href="#training-data" title="Link to this heading">#</a></h3>
<p>Training an RQA system <strong>end-to-end</strong> requires a collection of <strong>question-passage-answer triplets</strong>. Typically:</p>
<ul class="simple">
<li><p>to train a retrieval model, you would need a collection of (question, passage) pairs</p></li>
<li><p>to train a generative model, you would need a collection of (question, passage, answer) triplets</p></li>
</ul>
<p>However, the exact requirement depends on <strong>what training algorithms you want to use</strong>. For more details, you can refer to <a class="reference internal" href="training.html#train-main"><span class="std std-ref">Training</span></a>.</p>
</section>
<section id="evaluation-data">
<h3>Evaluation Data<a class="headerlink" href="#evaluation-data" title="Link to this heading">#</a></h3>
<p>LocalRQA provides two ways to evaluate an RQA system: automatic evaluation (see <a class="reference internal" href="evaluation.html#evaluation-main"><span class="std std-ref">Evaluation</span></a>) and human evaluation (see <a class="reference internal" href="serving/human_eval.html#serving-human-eval"><span class="std std-ref">Static Human Evaluation</span></a>). If you have access to ground-truth question-passage-answer triplets, you should be good for all evaluation functionalities we provide in this package. Alternatively, if you only wish to use a subset of the evaluation pipelines:</p>
<ul class="simple">
<li><p><strong>automatic evaluation of a retrieval model</strong> requires ground-truth question-passage pairs</p></li>
<li><p><strong>automatic evaluation of a generative model</strong> requires ground-truth question-passage-answer triplets</p></li>
<li><p><strong>human evaluation</strong> requires a collection of questions (and optionally passages)</p></li>
</ul>
<p>For more details on running those evaluations, you can refer to <a class="reference internal" href="evaluation.html#evaluation-main"><span class="std std-ref">Evaluation</span></a>.</p>
</section>
<section id="serving-data">
<h3>Serving Data<a class="headerlink" href="#serving-data" title="Link to this heading">#</a></h3>
<p>Finally, to deploy your RQA system either for human evaluation or just as a chatbot, you will need a collection of documents acting as a database. A document is simply <strong>a piece of text plus some metadata</strong> (e.g., title, URL), which can be used to provide additional context to the generative model and to the user.</p>
<p>When serving your RQA system with <a class="reference internal" href="serving.html#serving-main"><span class="std std-ref">Serving</span></a>, we will also automatically create a vector index of the document database you provided. This is because embedding a large document database may take time, so saving them prevents you from having to re-embed the documents every time you restart the server.</p>
<p>For more details on how to deploy your RQA system, you can refer to <a class="reference internal" href="serving.html#serving-main"><span class="std std-ref">Serving</span></a>.</p>
</section>
</section>
<section id="data-schema">
<h2>Data Schema<a class="headerlink" href="#data-schema" title="Link to this heading">#</a></h2>
<p>At the beginning of this section, we provided two simplified examples of how a document/passage is formatted. In practice, your data source can come from any format (e.g., docs from Google Drive, texts from a website), so it is important to <strong>store additional information</strong> beyond the text itself.</p>
<p>LocalRQA considers a uniform schema to represent these documents as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Document</span><span class="p">:</span>
    <span class="n">page_content</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">fmt_content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>  <span class="c1"># content formatted with metadata information</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>
</pre></div>
</div>
<p>so that you have:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">page_content</span></code> stores the raw text of the document</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">metadata</span></code> is a dictionary that is used to store all kinds of additional information about the document (e.g., title, URL, author, etc.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fmt_content</span></code> is a re-formated version of <code class="docutils literal notranslate"><span class="pre">page_content</span></code>, using some of the metadata information. This is the <strong>actual text used by retriever and generative models</strong>.</p></li>
</ul>
<p>Therefore, the full version of the document database looks like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;page_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Configure access ...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;fmt_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Title: How to ...\nURL: ...\nContent: Configure access ...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;How to ...&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;page_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;## Updated required permissions ...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;fmt_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Title: ...\nURL: ...\nContent: Configure access ...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="err">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>and question-passage-answer looks like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;question&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;How can I enable a user to access a specific table in Databricks?&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;passage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;page_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Configure access to ...&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;fmt_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}},</span>
<span class="w">        </span><span class="nt">&quot;answer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;To enable a user to access a specific table in Databricks, you can follow these steps: ...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;question&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;How can I access ADLS2 with UC external locations in Databricks?&quot;</span>
<span class="w">        </span><span class="nt">&quot;passage&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;page_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;## Access &lt;ADLS2&gt; ...&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;fmt_content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}},</span>
<span class="w">        </span><span class="nt">&quot;answer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;You can access Azure Data Lake Storage Gen2 (ADLS2) with Unity Catalog (UC) by ...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="err">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>For <strong>more complete examples</strong> of these data, see <a class="reference internal" href="data/data_description.html#data-description"><span class="std std-ref">RQA Data Format</span></a>.</p>
</section>
<section id="how-to-obtain-rqa-data">
<h2>How to Obtain RQA Data?<a class="headerlink" href="#how-to-obtain-rqa-data" title="Link to this heading">#</a></h2>
<p>Adding up all the data requirements, you may be wondering how to obtain: 1) a collection of documents as a database, and 2) a collection of question-passage pairs or question-passage-answer triplets. In general, we provide two methods:</p>
<ul class="simple">
<li><p><strong>Create your own data from scratch</strong>: starting from your own data source (supported by <code class="docutils literal notranslate"><span class="pre">langchain</span></code> or <code class="docutils literal notranslate"><span class="pre">llama-index</span></code>), you can create question-passage-answer using sampling algorithms and an LLM.</p></li>
<li><p><strong>Convert from existing QA datasets</strong>: many existing QA datasets, such as Natural Questions (Kwiatkowski et al., 2019), TriviaQA (Joshi et al., 2017), and MS-Marco (Bajaj et al., 2018) contain question-passage-answer triplets. We provide one-line commands to convert these datasets into the format required by LocalRQA.</p></li>
</ul>
<p>For more details, you can refer to <a class="reference internal" href="data/data_preparation.html#data-preparation"><span class="std std-ref">Prepare RQA Data</span></a>.</p>
<p><strong>References</strong></p>
<ul class="simple">
<li><p>Tom Kwiatkowski, Jennimaria Palomaki, Olivia Redfield, Michael Collins, Ankur Parikh, Chris Alberti, Danielle Epstein, Illia Polosukhin, Jacob Devlin, Kenton Lee, Kristina Toutanova, Llion Jones, Matthew Kelcey, Ming-Wei Chang, Andrew M. Dai, Jakob Uszkoreit, Quoc Le, and Slav Petrov. 2019. Natural Questions: a benchmark for question answering research. Transactions of the Association for Computational Linguistics, 7:452â€“466.</p></li>
<li><p>Mandar Joshi, Eunsol Choi, Daniel Weld, and Luke Zettlemoyer. 2017. TriviaQA: A large scale distantly supervised challenge dataset for reading comprehension. In Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), pages 1601â€“1611, Vancouver, Canada. Association for Computational Linguistics</p></li>
<li><p>Payal Bajaj, Daniel Campos, Nick Craswell, Li Deng, Jianfeng Gao, Xiaodong Liu, Rangan Majumder, Andrew McNamara, Bhaskar Mitra, Tri Nguyen, Mir Rosenberg, Xia Song, Alina Stoica, Saurabh Tiwary, and Tong Wang. 2018. MS-Marco: A human generated machine reading comprehension dataset.</p></li>
</ul>
<div class="toctree-wrapper compound">
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../getting_started/quickstart.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Quickstart</p>
      </div>
    </a>
    <a class="right-next"
       href="data/data_description.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">RQA Data Format</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-data-do-we-need">What Data Do We Need?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-data">Training Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluation-data">Evaluation Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#serving-data">Serving Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-schema">Data Schema</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-obtain-rqa-data">How to Obtain RQA Data?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Xiao Yu, Yunan Lu
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024, Xiao Yu, Yunan Lu.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>